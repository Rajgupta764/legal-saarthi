"""
Draft Generator Service
Handles generating complaint letters and legal drafts in Hindi
"""

from datetime import datetime


class DraftService:
    """Service for generating legal drafts and complaint letters"""
    
    def __init__(self):
        # Draft templates for different issue types
        self.templates = {
            'land_dispute': self._generate_land_dispute_draft,
            'property_dispute': self._generate_land_dispute_draft,  # Same template
            'family_dispute': self._generate_family_dispute_draft,
            'domestic_violence': self._generate_domestic_violence_draft,
            'consumer_complaint': self._generate_consumer_complaint_draft,
            'employment_issue': self._generate_employment_draft,
            'police_complaint': self._generate_police_complaint_draft,
            'court_affidavit': self._generate_court_affidavit_draft,
            'rti_application': self._generate_rti_draft,
            'pension_issue': self._generate_pension_draft,
            'caste_certificate': self._generate_certificate_draft,
            'ration_card': self._generate_ration_card_draft,
            'other': self._generate_general_draft
        }
        
        self.current_date = datetime.now().strftime('%d/%m/%Y')
    
    def generate_draft(self, issue_type, details):
        """
        Generate a complaint letter based on issue type and details
        """
        # Get the appropriate template function
        template_func = self.templates.get(issue_type, self._generate_general_draft)
        
        # Generate draft
        result = template_func(details)
        
        return result
    
    def _generate_land_dispute_draft(self, details):
        """Generate land dispute complaint letter"""
        draft = f"""सेवा में,
श्रीमान जिलाधिकारी/उप-जिलाधिकारी महोदय,
जिला कार्यालय,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: भूमि विवाद/अवैध कब्ज़े के संबंध में शिकायत

महोदय,

सविनय निवेदन है कि मैं [आपका नाम], निवासी [पूरा पता], आपके संज्ञान में निम्नलिखित भूमि विवाद लाना चाहता/चाहती हूँ:

समस्या का विवरण:
{details}

मेरी ज़मीन का विवरण:
• खसरा नंबर: [खसरा नंबर भरें]
• खाता नंबर: [खाता नंबर भरें]
• क्षेत्रफल: [क्षेत्रफल भरें]
• ग्राम/मोहल्ला: [स्थान भरें]

अतः श्रीमान से विनम्र निवेदन है कि मेरी शिकायत पर उचित कार्यवाही करते हुए मुझे न्याय दिलाने की कृपा करें।

संलग्नक:
1. खसरा-खतौनी की प्रमाणित प्रति
2. भूमि का नक्शा
3. पहचान पत्र की प्रति
4. अन्य संबंधित दस्तावेज़

धन्यवाद सहित,

भवदीय,
[आपका नाम]
[मोबाइल नंबर]
[पूरा पता]"""

        return {
            'draft': draft,
            'tips': [
                'खसरा-खतौनी की प्रमाणित प्रति अवश्य संलग्न करें',
                'शिकायत की 2 प्रतियां बनाएं - एक अपने पास रखें',
                'जमा करते समय रसीद अवश्य लें',
                'तहसीलदार कार्यालय में भी प्रति जमा करें'
            ],
            'submitTo': [
                'जिलाधिकारी कार्यालय',
                'तहसीलदार कार्यालय',
                'राजस्व विभाग'
            ]
        }
    
    def _generate_family_dispute_draft(self, details):
        """Generate family dispute application"""
        draft = f"""सेवा में,
श्रीमान न्यायाधीश महोदय,
परिवार न्यायालय,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: पारिवारिक विवाद के संबंध में आवेदन

महोदय,

सविनय निवेदन है कि मैं [आपका नाम], पुत्र/पुत्री/पत्नी [पिता/पति का नाम], निवासी [पूरा पता], निम्नलिखित पारिवारिक विवाद के समाधान हेतु आपकी सेवा में उपस्थित हूँ:

समस्या का विवरण:
{details}

परिवार का विवरण:
• विवाह की तिथि: [तिथि भरें]
• बच्चों की संख्या: [संख्या भरें]
• वर्तमान स्थिति: [स्थिति लिखें]

प्रार्थना:
अतः श्रीमान से विनम्र निवेदन है कि मेरे प्रकरण की सुनवाई कर उचित आदेश पारित करने की कृपा करें।

संलग्नक:
1. विवाह प्रमाण पत्र
2. पहचान पत्र
3. निवास प्रमाण
4. अन्य संबंधित दस्तावेज़

धन्यवाद सहित,

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]
[पूरा पता]"""

        return {
            'draft': draft,
            'tips': [
                'पहले परिवार परामर्श केंद्र से संपर्क करें',
                'विवाह प्रमाण पत्र अवश्य संलग्न करें',
                'महिला हेल्पलाइन 181 से मार्गदर्शन लें',
                'मुफ्त कानूनी सहायता के लिए DLSA से संपर्क करें'
            ],
            'submitTo': [
                'परिवार न्यायालय',
                'महिला आयोग',
                'जिला विधिक सेवा प्राधिकरण'
            ]
        }
    
    def _generate_domestic_violence_draft(self, details):
        """Generate domestic violence complaint"""
        draft = f"""सेवा में,
श्रीमान थानाध्यक्ष/महिला थाना प्रभारी,
थाना [थाने का नाम],
[जिले का नाम]

दिनांक: {self.current_date}

विषय: घरेलू हिंसा की शिकायत - धारा 498A IPC / घरेलू हिंसा अधिनियम 2005

महोदय,

मैं [आपका नाम], पत्नी [पति का नाम], निवासी [पूरा पता], निम्नलिखित शिकायत दर्ज करवाना चाहती हूँ:

घटना का विवरण:
{details}

आरोपी का विवरण:
• नाम: [आरोपी का नाम]
• संबंध: [संबंध]
• पता: [आरोपी का पता]

प्रार्थना:
1. मेरी FIR दर्ज की जाए
2. आरोपियों के विरुद्ध कार्यवाही की जाए
3. मुझे सुरक्षा प्रदान की जाए

संलग्नक:
1. पहचान पत्र
2. मेडिकल रिपोर्ट (यदि हो)
3. विवाह प्रमाण पत्र
4. फोटो/अन्य प्रमाण

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]"""

        return {
            'draft': draft,
            'tips': [
                'तुरंत 100 या महिला हेल्पलाइन 181 पर कॉल करें',
                'चोट लगी हो तो पहले मेडिकल जाँच करवाएं',
                'FIR की कॉपी अवश्य लें',
                'One Stop Centre से मदद लें'
            ],
            'submitTo': [
                'नज़दीकी पुलिस थाना',
                'महिला थाना',
                'महिला आयोग'
            ],
            'emergencyContacts': [
                {'name': 'पुलिस', 'number': '100'},
                {'name': 'महिला हेल्पलाइन', 'number': '181'},
                {'name': 'महिला आयोग', 'number': '7827-170-170'}
            ]
        }
    
    def _generate_consumer_complaint_draft(self, details):
        """Generate consumer complaint"""
        draft = f"""सेवा में,
श्रीमान अध्यक्ष,
जिला उपभोक्ता विवाद निवारण आयोग,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: उपभोक्ता शिकायत - सेवा में कमी/दोषपूर्ण उत्पाद

महोदय,

मैं [आपका नाम], निवासी [पूरा पता], निम्नलिखित उपभोक्ता शिकायत दर्ज करना चाहता/चाहती हूँ:

शिकायत का विवरण:
{details}

प्रतिवादी (विक्रेता/कंपनी) का विवरण:
• नाम: [कंपनी/दुकान का नाम]
• पता: [पता]
• खरीदारी की तिथि: [तिथि]
• रसीद/बिल नंबर: [नंबर]
• भुगतान की राशि: ₹[राशि]

क्षतिपूर्ति की माँग:
1. रिफंड/बदली: ₹[राशि]
2. मानसिक क्षतिपूर्ति: ₹[राशि]
3. वाद व्यय: ₹[राशि]

संलग्नक:
1. खरीदारी की रसीद/बिल
2. वारंटी कार्ड
3. उत्पाद की फोटो
4. पत्राचार की प्रतियाँ

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]
[ईमेल]"""

        return {
            'draft': draft,
            'tips': [
                'पहले विक्रेता को लिखित शिकायत दें',
                'consumerhelpline.gov.in पर ऑनलाइन शिकायत करें',
                'बिल और वारंटी कार्ड अवश्य संलग्न करें',
                '₹1 लाख तक की शिकायत पर कोई फीस नहीं'
            ],
            'submitTo': [
                'जिला उपभोक्ता फोरम',
                'National Consumer Helpline (1800-11-4000)',
                'ई-दाखिल पोर्टल (edaakhil.nic.in)'
            ]
        }
    
    def _generate_employment_draft(self, details):
        """Generate employment related complaint"""
        draft = f"""सेवा में,
श्रीमान श्रम आयुक्त/सहायक श्रम आयुक्त,
श्रम विभाग,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: वेतन/सेवा संबंधी शिकायत

महोदय,

मैं [आपका नाम], कर्मचारी [कंपनी का नाम], निम्नलिखित शिकायत दर्ज करना चाहता/चाहती हूँ:

शिकायत का विवरण:
{details}

नियोक्ता का विवरण:
• कंपनी का नाम: [नाम]
• पता: [पता]
• कार्य की अवधि: [तिथि से तिथि तक]
• पद: [पद का नाम]
• मासिक वेतन: ₹[राशि]

बकाया राशि का विवरण:
• वेतन बकाया: ₹[राशि]
• PF बकाया: ₹[राशि]
• अन्य: ₹[राशि]

संलग्नक:
1. नियुक्ति पत्र
2. सैलरी स्लिप
3. PF स्टेटमेंट
4. पहचान पत्र

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]"""

        return {
            'draft': draft,
            'tips': [
                'नियुक्ति पत्र और सैलरी स्लिप ज़रूरी हैं',
                'PF शिकायत के लिए EPFO पोर्टल पर जाएं',
                'श्रम हेल्पलाइन 14434 पर कॉल करें',
                '90 दिन के अंदर शिकायत करें'
            ],
            'submitTo': [
                'श्रम विभाग कार्यालय',
                'श्रम न्यायालय',
                'EPFO कार्यालय (PF संबंधी)'
            ]
        }
    
    def _generate_police_complaint_draft(self, details):
        """Generate police complaint (FIR)"""
        draft = f"""सेवा में,
श्रीमान थानाध्यक्ष,
थाना [थाने का नाम],
[जिले का नाम]

दिनांक: {self.current_date}

विषय: प्राथमिकी (FIR) दर्ज करने हेतु प्रार्थना पत्र

महोदय,

मैं [आपका नाम], पुत्र/पुत्री [पिता का नाम], निवासी [पूरा पता], निम्नलिखित घटना की शिकायत दर्ज करवाना चाहता/चाहती हूँ:

घटना का विवरण:
{details}

घटना की जानकारी:
• घटना की तिथि: [तिथि]
• घटना का समय: [समय]
• घटना का स्थान: [स्थान]

आरोपी का विवरण (यदि ज्ञात हो):
• नाम: [नाम]
• पता: [पता]
• पहचान: [विवरण]

गवाह (यदि कोई हो):
1. [गवाह का नाम और पता]

प्रार्थना:
कृपया मेरी FIR दर्ज कर उचित कार्यवाही करें।

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]
[पता]"""

        return {
            'draft': draft,
            'tips': [
                'FIR दर्ज होने पर कॉपी अवश्य लें',
                'यदि FIR न लिखी जाए तो SP/DM को शिकायत करें',
                'ऑनलाइन FIR: राज्य पुलिस वेबसाइट पर',
                'Zero FIR का विकल्प भी उपलब्ध है'
            ],
            'submitTo': [
                'नज़दीकी पुलिस थाना',
                'SP कार्यालय (यदि थाने में न सुनी जाए)',
                'ऑनलाइन FIR पोर्टल'
            ]
        }
    
    def _generate_court_affidavit_draft(self, details):
        """Generate court affidavit (शपथ पत्र)"""
        draft = f"""शपथ पत्र
(Affidavit)

न्यायालय श्रीमान [न्यायाधीश पद], [न्यायालय का नाम]
[जिले का नाम], [राज्य]

वाद संख्या: _______________
[वादी का नाम] ........................ वादी
बनाम
[प्रतिवादी का नाम] ........................ प्रतिवादी

दिनांक: {self.current_date}

मैं [आपका नाम], पुत्र/पुत्री/पत्नी [पिता/पति का नाम], आयु [उम्र] वर्ष, निवासी [पूरा पता], शपथपूर्वक कथन करता/करती हूँ कि:

1. मैं उपरोक्त वाद में वादी/प्रतिवादी/साक्षी हूँ और इस मामले से पूर्ण रूप से परिचित हूँ।

2. निम्नलिखित तथ्य मेरी व्यक्तिगत जानकारी में हैं और सत्य हैं:

{details}

3. यह शपथ पत्र स्वेच्छा से बिना किसी दबाव या प्रलोभन के दिया जा रहा है।

4. इस शपथ पत्र की सामग्री मेरी जानकारी और विश्वास के अनुसार सत्य है। इसमें कुछ भी छिपाया नहीं गया है और कोई भाग असत्य नहीं है।

5. मुझे ज्ञात है कि यदि इस शपथ पत्र में कोई बात असत्य पाई गई तो मेरे विरुद्ध भारतीय दण्ड संहिता की धारा 191/199 के अंतर्गत मिथ्या साक्ष्य/मिथ्या शपथ पत्र हेतु कार्यवाही की जा सकती है।

सत्यापन:
मैं उपरोक्त शपथ पत्र की सामग्री को सत्य एवं सही पाते हुए आज दिनांक _____________ को [स्थान] में सत्यापित करता/करती हूँ।

शपथकर्ता

_______________________
(हस्ताक्षर)
[आपका नाम]

_______________________
(नोटरी/ओथ कमिश्नर की मुहर एवं हस्ताक्षर)

संलग्नक:
1. पहचान पत्र (आधार/वोटर ID)
2. पासपोर्ट साइज़ फोटो"""

        return {
            'draft': draft,
            'tips': [
                'शपथ पत्र को नोटरी से सत्यापित कराना अनिवार्य है',
                'नोटरी शुल्क ₹10-50 होता है',
                '₹10 का स्टांप पेपर पर लिखें',
                'सभी तथ्य सत्य लिखें - मिथ्या शपथ पत्र अपराध है',
                'दो प्रतियाँ बनवाएं - एक कोर्ट के लिए, एक अपने पास'
            ],
            'submitTo': [
                'संबंधित न्यायालय',
                'नोटरी कार्यालय (सत्यापन हेतु)',
                'ओथ कमिश्नर कार्यालय'
            ]
        }
    
    def _generate_rti_draft(self, details):
        """Generate RTI application"""
        draft = f"""सेवा में,
श्रीमान जन सूचना अधिकारी (PIO),
[विभाग का नाम],
[कार्यालय का पता]

दिनांक: {self.current_date}

विषय: सूचना का अधिकार अधिनियम, 2005 के तहत सूचना प्राप्ति हेतु आवेदन

महोदय,

सूचना का अधिकार अधिनियम, 2005 की धारा 6(1) के अंतर्गत मैं निम्नलिखित सूचना प्राप्त करना चाहता/चाहती हूँ:

मांगी गई सूचना का विवरण:
{details}

सूचना का प्रारूप: [प्रिंट/फोटोकॉपी/सॉफ्ट कॉपी]

सूचना की अवधि: [तिथि से तिथि तक]

मैं इस आवेदन के साथ ₹10 (दस रुपये) का शुल्क [पोस्टल ऑर्डर/कोर्ट फीस स्टांप/ऑनलाइन] के माध्यम से जमा कर रहा/रही हूँ।

[यदि BPL हों तो: मैं गरीबी रेखा से नीचे (BPL) श्रेणी में आता/आती हूँ, अतः मुझे शुल्क से छूट प्राप्त है। BPL कार्ड की प्रति संलग्न है।]

आवेदक का विवरण:
नाम: [आपका नाम]
पता: [पूरा पता]
फोन: [मोबाइल नंबर]
ईमेल: [ईमेल]

हस्ताक्षर
[आपका नाम]"""

        return {
            'draft': draft,
            'tips': [
                'आवेदन शुल्क ₹10 है (BPL के लिए मुफ्त)',
                '30 दिनों में जवाब मिलना चाहिए',
                'जवाब न मिले तो प्रथम अपीलीय अधिकारी को लिखें',
                'rtionline.gov.in पर ऑनलाइन भी आवेदन कर सकते हैं'
            ],
            'submitTo': [
                'संबंधित विभाग का PIO कार्यालय',
                'rtionline.gov.in (केंद्र सरकार के लिए)',
                'राज्य RTI पोर्टल (राज्य सरकार के लिए)'
            ]
        }
    
    def _generate_pension_draft(self, details):
        """Generate pension related application"""
        draft = f"""सेवा में,
श्रीमान जिला समाज कल्याण अधिकारी/पेंशन अधिकारी,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: वृद्धावस्था/विधवा/विकलांग पेंशन हेतु आवेदन/शिकायत

महोदय,

मैं [आपका नाम], आयु [उम्र] वर्ष, निवासी [पूरा पता], निम्नलिखित निवेदन करता/करती हूँ:

विवरण:
{details}

व्यक्तिगत जानकारी:
• जन्म तिथि: [तिथि]
• आधार नंबर: [नंबर]
• बैंक खाता: [खाता नंबर]
• IFSC कोड: [कोड]

संलग्नक:
1. आधार कार्ड
2. आयु प्रमाण पत्र
3. आय प्रमाण पत्र
4. बैंक पासबुक की प्रति
5. फोटो

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]"""

        return {
            'draft': draft,
            'tips': [
                'आयु प्रमाण के लिए जन्म प्रमाण पत्र/आधार दें',
                'बैंक खाता आधार से लिंक होना चाहिए',
                'आवेदन जमा करने की रसीद लें',
                'ऑनलाइन आवेदन भी कर सकते हैं'
            ],
            'submitTo': [
                'समाज कल्याण विभाग',
                'ब्लॉक/तहसील कार्यालय',
                'CSC केंद्र (ऑनलाइन आवेदन)'
            ]
        }
    
    def _generate_certificate_draft(self, details):
        """Generate certificate application"""
        draft = f"""सेवा में,
श्रीमान तहसीलदार/उप-जिलाधिकारी,
तहसील कार्यालय,
[तहसील का नाम], [जिले का नाम]

दिनांक: {self.current_date}

विषय: जाति/आय/निवास प्रमाण पत्र हेतु आवेदन

महोदय,

मैं [आपका नाम], पुत्र/पुत्री [पिता का नाम], निवासी [पूरा पता], निम्नलिखित प्रमाण पत्र प्राप्त करना चाहता/चाहती हूँ:

विवरण:
{details}

व्यक्तिगत जानकारी:
• जन्म तिथि: [तिथि]
• जाति: [जाति]
• पिता का व्यवसाय: [व्यवसाय]
• वार्षिक आय: ₹[राशि]

संलग्नक:
1. आधार कार्ड
2. राशन कार्ड
3. पहचान पत्र
4. पुराना प्रमाण पत्र (यदि हो)
5. फोटो

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]"""

        return {
            'draft': draft,
            'tips': [
                'ऑनलाइन आवेदन करें - तेज़ और आसान',
                'सभी दस्तावेज़ों की स्व-प्रमाणित प्रति दें',
                'CSC केंद्र से भी बनवा सकते हैं',
                '15-30 दिनों में प्रमाण पत्र मिलना चाहिए'
            ],
            'submitTo': [
                'तहसील कार्यालय',
                'CSC/जन सेवा केंद्र',
                'ई-डिस्ट्रिक्ट पोर्टल (ऑनलाइन)'
            ]
        }
    
    def _generate_ration_card_draft(self, details):
        """Generate ration card application"""
        draft = f"""सेवा में,
श्रीमान जिला आपूर्ति अधिकारी,
खाद्य एवं रसद विभाग,
[जिले का नाम]

दिनांक: {self.current_date}

विषय: नया राशन कार्ड/राशन कार्ड में संशोधन हेतु आवेदन

महोदय,

मैं [आपका नाम], निवासी [पूरा पता], निम्नलिखित निवेदन करता/करती हूँ:

विवरण:
{details}

परिवार की जानकारी:
• परिवार के मुखिया का नाम: [नाम]
• कुल सदस्य: [संख्या]
• वार्षिक आय: ₹[राशि]

परिवार के सदस्यों का विवरण:
1. [नाम] - [संबंध] - [आयु]
2. [नाम] - [संबंध] - [आयु]

संलग्नक:
1. आधार कार्ड (सभी सदस्यों के)
2. आय प्रमाण पत्र
3. निवास प्रमाण
4. पासपोर्ट साइज़ फोटो

प्रार्थी,
[आपका नाम]
[मोबाइल नंबर]"""

        return {
            'draft': draft,
            'tips': [
                'सभी सदस्यों के आधार कार्ड ज़रूरी हैं',
                'ऑनलाइन आवेदन करें - nfsa.gov.in',
                'फोटो और बायोमेट्रिक के लिए बुलाया जाएगा',
                'e-Ration Card ऐप से स्टेटस चेक करें'
            ],
            'submitTo': [
                'खाद्य एवं रसद विभाग',
                'CSC/जन सेवा केंद्र',
                'nfsa.gov.in (ऑनलाइन)'
            ]
        }
    
    def _generate_general_draft(self, details):
        """Generate general complaint letter"""
        draft = f"""सेवा में,
श्रीमान [अधिकारी का पद],
[विभाग/कार्यालय का नाम],
[पता]

दिनांक: {self.current_date}

विषय: शिकायत/आवेदन

महोदय,

सविनय निवेदन है कि मैं [आपका नाम], निवासी [पूरा पता], आपके संज्ञान में निम्नलिखित विषय लाना चाहता/चाहती हूँ:

विवरण:
{details}

अतः श्रीमान से विनम्र निवेदन है कि मेरी समस्या पर उचित कार्यवाही करने की कृपा करें।

संलग्नक:
1. पहचान पत्र
2. संबंधित दस्तावेज़

धन्यवाद सहित,

भवदीय,
[आपका नाम]
[मोबाइल नंबर]
[पता]
[ईमेल]"""

        return {
            'draft': draft,
            'tips': [
                'शिकायत की 2 प्रतियां बनाएं',
                'जमा करते समय रसीद अवश्य लें',
                'संबंधित दस्तावेज़ संलग्न करें',
                'जिला विधिक सेवा से मार्गदर्शन लें'
            ],
            'submitTo': [
                'संबंधित विभाग/कार्यालय',
                'जिलाधिकारी कार्यालय',
                'लोकायुक्त (यदि भ्रष्टाचार संबंधी हो)'
            ]
        }
